(function(n,t){function i(i){var r;return{ctor:function(){this.data=[];this.nodes={};this.key="";this.value="默认";this.node=null;this.pageIndex=1;this.pageSize=100;this.indentGuide=!0},init:function(){this.base.init();this.$=n(this.element)},render:function(){this.base.render();this.indentGuide&&this.addClass("tree-view-indent-guide")},wait:function(n){this.__wait_==null&&(this.__wait_=this.constructor("wait",{sm:!0,fade:!0,context:this.element}));this.__wait_.toggle(n)},ajax:function(){var u={url:null,type:"GET",params:{parentId:r||"",page:this.pageIndex,size:this.pageSize}};this.invoke("ajax-ready",u)!==!1&&(this.wait(!0),n.ajax(u.url,{type:u.type,dataType:"json",data:u.params,success:function(n){i.invoke("ajax-success",n)!==!1&&(n.status?(i.invoke("ajax-load",n),i.sleep(!1)&&i.load(),i.invoke("ajax-complete")):t.validate("<strong>错误&ensp;:<\/strong>&ensp;&ensp;"+n.message+"","danger"));i.wait(!1)},error:function(n){i.invoke("ajax-error",n.status,n);i.wait(!1)}}))},ajaxLoad:function(n){this.data=n.data},load:function(){this.resolve()},resolve:function(){this.nodes[r||"*"]=this.data;var n=t.expression('<ul>{for(var item in data){ if(item.hasChildren) { "<li data-key="{item.id}"><em data-sign="+">+<\/em><em data-sign="-">-<\/em><span data-domain="true" style="color: rgb()">{item.name}<\/span><\/li>" } else { "<li data-key="{item.id}"><span data-domain="true">{item.name}<\/span><\/li>" } }^}<\/ul>',this.data);r?this.$.find('[data-key="'+r+'"]').append(n):this.$.append(n)},commit:function(){this.$.on("click","[data-key]",function(){var r=n(this);return r.hasClass("active")?!1:(i.key=r.attr("data-key"),i.value=r.children('[data-domain="true"]').text(),i.node=function(n){return t.find(n||i.nodes["*"],function(n){return n.id==i.key})}(i.nodes[r.parentsUntil(".expand").parent().attr("data-key")]),i.$.find(".active").removeClass("active"),r.addClass("active"),i.invoke("select-change",i.node),!1)});this.$.on("click",'[data-sign="+"]',function(){return r=n(this).parent().addClass("expand").attr("data-key"),i.nodes[r]||i.ajax(),!1});this.$.on("click",'[data-sign="-"]',function(){return n(this).parent().removeClass("expand"),!1})}}}t.register("treeView",i)})(jQuery,v2Kit);