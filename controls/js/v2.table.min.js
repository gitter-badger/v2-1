/*!
 * JavaScript v2 v1.0.1
 * https://github.com/v2kit/v2
 *
 * @author hyly
 * @date 2018-08-01
 * @descript a valuable technology object.
 */
(function(n,t){function i(n){return n==!0||n==1||n&&n.checked}function e(n,i,r,u){var f;if(r=!!r,i=~~i%n.pageSize,u=u||n.stateField,f=n.siteCache[u],f||f===0){var e=n.$thead.find(t.format('input[data-field="{0}"]',u)),o=n.$tbody.find(t.format('input[data-field="{0}"]',u)),s=o.eq(i),h=s.attr("type");h==="checkbox"?(s.prop("checked",r),(!r||t.every(o,function(n){return n.checked}))&&e.prop("checked",r)):(e.prop("checked")&&(e.prop("checked",!r),t.each(n.data,function(n){n[f]=!r})),o.prop("checked",!r),s.prop("checked",r));n.data[i][f]=r}}function o(n,i,r){var u,f;i=!!i;r=r||n.stateField;u=n.siteCache[r];(u||u===0)&&(f=n.$table.find(t.format('input[data-field="{0}"]',r)),f.prop("checked",i),t.each(n.data,function(n){n[u]=i}))}function p(p,w){var b={},d=function(n){b[n]=function(t,r){var u=['<label><input data-role="',n,'" type="',n,'" data-field="{field}" data-row-index="',r,'"'];return i(t)&&u.push(' checked="checked"'),u.push("/><\/label>"),u.join("")}},k={};return t.each(["checkbox","radio"],d),{ctor:function(){this.data=[];this.columns=[];this.format=b;this.pageIndex=1;this.pageSize=10;this.pageTotal=0},init:function(){this.base.init();this.$=n(this.element);this.$.append(l.join(""));this.$tableHorizontal=this.$.children().last();this.$tableVertical=this.$tableHorizontal.children();this.$tableCore=this.$tableVertical.children();this.$tableScreen=this.$tableCore.next();this.$table=this.$tableCore.children();this.$colgroup=this.$table.find("colgroup");this.$thead=this.$colgroup.next();this.$tbody=this.$thead.next();this.$tfoot=this.$tbody.next();this.limitVerticalElement=this.$tableHorizontal.get(0)},render:function(n){this.base.render();n.responsive&&this.$tableHorizontal.addClass("table-responsive");n.border&&this.$table.addClass("table-bordered");n.hover&&this.$table.addClass("table-hover");n.compact&&this.$table.addClass("table-condensed");(n.headFixed||n.columnFixed)&&this.$.addClass("table-fixed");n.headFixed&&(this.$tableHorizontal.prepend(t.expression(a.join(""),n)),this.$headFixed=this.$tableHorizontal.find(".table-fixed-head"),this.$headFixedTable=this.$headFixed.find(".table"));n.columnFixed&&(this.$tableHorizontal.prepend(t.expression(v.join(""),n)),this.$columnFixed=this.$tableHorizontal.find(".table-fixed-column"),this.$columnFixedTable=this.$columnFixed.find(".table"),this.$columnFixedHead=this.$columnFixedTable.find("thead"),this.$columnFixedBody=this.$columnFixedHead.next(),n.headFixed&&(this.$tableHorizontal.append(t.expression(y.join(""),n)),this.$headColumnFixed=this.$tableHorizontal.find(".table-fixed-column.table-fixed-head"),this.$headColumnFixedHead=this.$headColumnFixed.find("thead")));(n.pagination=n.pagination&&h.test(n.paginationVAlign))&&this.pagination()},pagination:function(){(w.paginationVAlign==="top"||w.paginationVAlign=="both")&&this.$tableHorizontal.before(t.expression(s.join(""),this));(w.paginationVAlign==="bottom"||w.paginationVAlign=="both")&&this.$tableHorizontal.after(t.expression(s.join(""),this));this.paginationEl=this.$.find(".table-pagination");this.paginationInfo=this.paginationEl.find(".pagination-info");this.paginationSize=this.paginationEl.find(".page-size");this.paginationDropdown=this.paginationEl.find(".dropdown-menu");this.navigationEl=this.paginationEl.find(".pagination");(w.paginationVAlign==="bottom"||w.paginationVAlign=="both")&&this.paginationDropdown.eq(-1).parent().addClass("dropup");this.navigationPre=this.navigationEl.find('[aria-label="previous"]');this.navigationNext=this.navigationEl.find('[aria-label="next"]');this.updatePaginationList();this.initPagination()},initPagination:function(){if(w.pagination){var u,i,f,r=[],t=this.pageIndex,n=Math.ceil(this.pageTotal/this.pageSize),e=function(n,i){for(;n<=i;n++)r.push("<li "),t===n&&r.push('class="active" '),r.push('data-role="pagination"><a href="javascript:void(0)">'+n+"<\/a><\/li>")};if(this.totalPages=n,this.pageTotal<1)return this.paginationEl.addClass("hidden");this.paginationEl.removeClass("hidden");u=1;i=t<6?Math.min(n,5):~~(t>n-4)+2;e(u,i);n>10&&(t>5&&r.push('<li class="disabled" data-role="pagination"><a href="javascript:void(0)">...<\/a><\/li>'),f=~~(t<5||t==n-4),u=t>n-5?n-f-4:Math.max(i+1,t-1),e(u,i=Math.min(t+1,n-1)),t<n-4&&r.push('<li class="disabled" data-role="pagination"><a href="javascript:void(0)">...<\/a><\/li>'),i=Math.max(i,n-f-2));e(i+1,n);this.navigationEl.children('[data-role="pagination"]').remove();this.navigationPre.after(r.join(""));this.navigationPre.toggleClass("disabled",w.paginationLoop?this.totalPages===1:this.pageIndex===1);this.navigationNext.toggleClass("disabled",w.paginationLoop?this.totalPages===1:this.totalPages===this.pageIndex);this.updatePaginationText();this.paginationSize.text(this.pageSize)}},updatePagination:function(n,t){w.pagination&&(n=n==null?this.pageIndex:~~n,n=this.pageIndex+n,this.pageIndex=n-this.pageIndex,n=n-this.pageIndex,t=~~t||(t=this.pageSize),t=t+this.pageSize,this.pageSize=t-this.pageSize,t=t-this.pageSize,w.paginationLoop?this.pageIndex<1?this.pageIndex=this.totalPages:this.pageIndex>this.totalPages&&(this.pageIndex=1):(this.navigationPre.toggleClass("disabled",this.pageIndex===1),this.navigationNext.toggleClass("disabled",this.totalPages===this.pageIndex)),(this.pageIndex!=n||this.pageSize!=t)&&this.ajax(),this.updatePaginationText(),this.totalPages>7||this.pageSize!=t?this.initPagination():this.navigationEl.children('[data-role="pagination"]').eq(this.pageIndex-1).addClass("active").siblings().removeClass("active"))},updatePaginationText:function(n,t,i){n=this.pageTotal=~~n||this.pageTotal;i=this.pageSize=~~i||this.pageSize;t=this.pageIndex=~~t||this.pageIndex;this.paginationInfo.find("var").text(function(r){return(r=r%3)?r>1?n:Math.min(n,i*t):i*(t-1)+1})},updatePaginationList:function(n){if(w.pagination){var i=[];t.each(w.paginationList=n||w.paginationList||[10,25,50,100],function(n){i.push('<li role="menuitem"');p.pageSize==n&&i.push('<li role="menuitem" class="active"');i.push('><a href="javascript:void(0)">'+n+"<\/a><\/li>")});this.paginationDropdown.empty().append(i.join("")).children()}},update:function(n,i){i=~~i;i=i-this.pageSize*(this.pageIndex-1)-1;t.removeAt(this.data,i);t.insertAt(this.data,i,n);this.load()},removeAt:function(n){n=~~n;var r=this.pageTotal%this.pageSize,i=Math.ceil(n/this.pageSize);r===1&&(this.totalPages-=1);this.pageTotal-=1;r>1&&i===this.pageIndex&&i===this.totalPages?(n=n-this.pageSize*(this.pageIndex-1)-1,t.removeAt(this.data,n),this.load()):(this.pageIndex=Math.min(i,this.totalPages),this.ajax())},insert:function(n,t){t=~~t;var r=this.pageTotal%this.pageSize,i=Math.ceil(t/this.pageSize);r===0&&(this.totalPages+=1);this.pageTotal+=1;i===this.pageIndex?(this.data=this.data||[],t=t-this.pageSize*(i-1)-1,(r===0||i<this.totalPages)&&this.data.pop(),this.data.splice(t,0,n),this.load()):(this.pageIndex=i,this.ajax())},append:function(n){var i=this.pageTotal%this.pageSize;if(i===0&&(this.totalPages+=1),this.pageTotal+=1,this.pageIndex<this.totalPages)return this.pageIndex=this.totalPages,this.ajax();this.data=this.data||[];i>0?(this.data.push(n),this.updatePaginationText(),this.$tbody.append(this.tr(n,i,t.type(n)))):(this.refresh=!1,this.pageIndex+=1,this.data=new Array(n),this.load())},wait:function(n){this.__wait_==null&&(this.__wait_=this.constructor("wait",{sm:!0,fade:!0,context:this.element}));this.__wait_.toggle(n)},ajax:function(){var i={url:null,type:"GET",params:{page:this.pageIndex,size:this.pageSize}};this.invoke("ajax-ready",i)!==!1&&(this.wait(!0),t.every(i.params,function(n,t){return t==="Page"||t==="Size"||!n==!k[t]})||(this.isReady&&this.updatePagination(1),t.extend(k,t.extend(i.params,{page:this.pageIndex,size:this.pageSize}))),n.ajax(i.url,{type:i.type,dataType:"json",data:i.params,success:function(n){p.invoke("ajax-success",n)!==!1&&(n.status?(p.invoke("ajax-load",n),p.sleep(!1)&&p.load()):t.validate("<strong>错误&ensp;:<\/strong>&ensp;&ensp;"+n.message+"","danger"));p.wait(!1)},error:function(n){p.invoke("ajax-error",n.status,n);p.wait(!1)}}))},ajaxLoad:function(n){this.data=n.data;this.pageTotal=n.total;(this.refresh=!!n.columns)&&(this.columns=n.columns)},load:function(){this.refresh&&this.header();this.container();this.initPagination()},colgroup:function(){var n=t.map(this.columns,this.col,this);this.$colgroup.empty().append(n.join(""))},col:function(n){return n.width?t.format('<col width="{0}"/>',n.width):c},thead:function(){var i=t.map(this.columns,this.th,this),n;w.columnFixed&&(n=i.slice(0,this.fixedCount),n.unshift("<tr>"),n.push("<\/tr>"),this.$columnFixedHead.empty().append(n.join("")),w.headFixed&&this.$headColumnFixedHead.empty().append(n.join("")));i.unshift("<tr>");i.push("<\/tr>");this.$thead.empty().append(i.join(""))},th:function(n){var u,i=["<th"];return n.titleTooltip&&i.push(' title="{titleTooltip}"'),i.push('><div class="th-nowrap'),n.format&&(u=t.type(n.format),u==="string"&&(n[n.format]=!0,u=t.type(n.format=this.format[n.format])),n.format=u==="function"&&n.format),(n.checkbox||n.radio)&&i.push(n.checkbox?"checkbox":"radio"),n.align&&r.test(n.align)&&i.push(" text-{align}"),i.push('">'),n.checkbox||n.radio?i.push(t.format('<label><input type="{0}" data-field="{1}"/><\/label>',n.checkbox?"checkbox":"radio",n.field)):i.push("{title}"),i.push("<\/div><\/th>"),t.replace(i.join(""),n)},header:function(){var n=0;w.caption&&this.$table.find("caption").remove().prevObject.prepend("<caption>"+w.caption+"<\/caption>");this.fixedCount=0;this.siteCache={};t.each(this.columns,function(i,r){i.field==="#"&&(n-=1,this.hasSharp=!0,t.isFunction(i.format)&&(this.hasSharpFormat=!0));i.offset=r+n;(i.checkbox||i.radio)&&(this.siteCache[i.field]=r+n,this.stateField=this.stateField||i.field);w.columnFixed&&i.fixed&&(this.columns.splice(r,1),this.columns.splice(this.fixedCount++,0,i))},this);this.colgroup(this.columns);this.thead(this.columns)},tbody:function(){var n,i=[],e=[],o=this.data||[],s=this.columns||[],r,u,f;if(o.length?t.each(o,function(r,u){n=n||t.type(r);i.push(p.tr(r,u,n));w.columnFixed&&e.push(p.tr(r,u,n,p.fixedCount))}):(r=0,u=this.$thead.children().eq(0).children(),u.each(function(n){r+=~~u.eq(n).attr("colspan")||1}),i.push(t.format('<tr><td class="text-center" colspan="{0}">没有找到匹配的记录<\/td><\/tr>',r))),n==="object")for(f in this.siteCache)this.siteCache[f]=f;this.$tbody.empty().append(i.join(""));w.headFixed&&this.$headFixedTable.empty().append(this.$thead.clone());w.columnFixed&&this.$columnFixedBody.empty().append(e.join(""));setTimeout(this.proxy(this.restore),10)},tr:function(n,i,r,u){var e,o=["<tr"],h=this.columns||[],f=w.attributes,s,c;for(o.push(' data-row-index="',i=this.pageSize*(this.pageIndex-1)+(i>>>0)+1,'"'),f&&(t.isFunction(f)&&(f=f.call(p,i,n)),f&&t.isPlainObject(f)&&t.each(f,function(){o.push(t.format(' {1}="{0}"',arguments))})),o.push(">"),s=0,c=~~u||h.length;s<c;s++)e=h[s],o.push(p.td(e,e.field==="#"?i:r==="object"?n[e.field]:n[e.offset],i,n,e.offset));return o.push("<\/tr>"),o.join("")},td:function(n,i,u,f,e){var s,o=["<td"];return(n.checkbox||n.radio)&&o.push(t.format(' class="{0}"',n.checkbox?"checkbox":"radio")),n.height&&o.push(' height="{height}"'),n.align&&r.test(n.align)&&o.push(' align="{align}"'),n.field==="#"&&o.push(' data-sharp="#"'),(s=n.attributes)&&(t.isFunction(s)&&(s=s.call(p,i,u,f,e)),s&&t.isPlainObject(s)&&t.each(s,function(){o.push(t.format(' {1}="{0}"',arguments))})),o.push(">"),(n.nowrap||w.nowrap&&n.nowrap!==!1)&&o.push('<div class="td-nowrap">'),n.format&&(i=n.format(i,u,f,e)),o.push(i),(n.nowrap||w.nowrap&&n.nowrap!==!1)&&o.push("<\/div>"),o.push("<\/td>"),t.replace(o.join(""),n)},check:function(n,t){e(this,n,!0,t)},uncheck:function(n,t){e(this,n,!1,t)},checkAll:function(n){o(this,!0,n)},uncheckAll:function(n){o(this,!1,n)},getSelections:function(n){n=n||p.stateField;var r=this.siteCache[n];if(r||r===0)return t.find(this.data,function(t){return i(t[n])})},getAllSelections:function(n){n=n||p.stateField;var r=this.siteCache[n];return r||r===0?t.filter(this.data,function(t){return i(t[n])}):[]},container:function(){this.tbody();t.each(this.columns,function(n){if(n.radio||n.checkbox){var r=p.siteCache[n.field],u=t.format('input[data-field="{0}"]',n.field);p.$thead.find(u).prop("checked",t.every(p.data,function(n){return i(n[r])}))}})},footer:function(){this.$table.find("tfoot")},resolve:function(){this.header();this.container();this.footer()},restore:function(){var i,r,t,n;w.headFixed&&(t=this.$thead.find("th"),n=this.$headFixedTable.find("th"),n.each(function(i){n.eq(i).width(t.eq(i).width())}),i=this.$table.width(),this.$headFixed.width(this.$tableScreen.width()),this.$headFixedTable.css({width:i,"min-width":i}));w.columnFixed&&(r=0,t=this.$thead.find("tr:first-child th"),n=this.$columnFixedHead.find("tr:first-child th"),n.each(function(u){r+=i=t.eq(u).outerWidth();n.eq(u).outerWidth(i)}),this.$columnFixed.width(r-1),this.$columnFixed.height(this.$tableScreen.height()),w.headFixed&&(r=0,t=this.$columnFixedHead.find("th"),n=this.$headColumnFixedHead.find("th"),n.each(function(u){r+=i=t.eq(u).outerWidth();n.eq(u).outerWidth(i)}),this.$headColumnFixed.width(r-1)),t=this.$tbody.find("td:first-child"),n=this.$columnFixedBody.find("td:first-child"),n.each(function(i){n.eq(i).height(t.eq(i).height())}))},commit:function(){if((w.headFixed||w.columnFixed)&&n(window).resize(function(){p.restore()}),w.headFixed)this.$tableVertical.on("scroll",function(){p.$headFixed.prop("scrollLeft",this.scrollLeft)});if(w.columnFixed){var i;this.$tableVertical.on("scroll",function(){i&&clearTimeout(i);i=setTimeout(function(){p.$columnFixed.removeClass("shadow")},1e3);p.$columnFixed.addClass("shadow");p.$columnFixed.prop("scrollTop",this.scrollTop)});this.$.find("tbody").on("mouseenter","tr",function(){p.$.find(t.format('[data-row-index="{0}"]',n(this).attr("data-row-index"))).addClass("hover").siblings().removeClass("hover")}).on("mouseleave","tr",function(){p.$.find(t.format('[data-row-index="{0}"]',n(this).attr("data-row-index"))).removeClass("hover")})}this.$.on("click",'input[type="checkbox"],input[type="radio"]',function(){p[this.checked?"checkAll":"uncheckAll"](n(this).attr("data-field"))});this.$.on("click",'input[type="checkbox"],input[type="radio"]',function(){var t=n(this);p[this.checked?"check":"uncheck"](~~t.attr("data-row-index")-1,t.attr("data-field"))});this.$.on("click",'[aria-label="previous"]',function(){return f.test(this.className)||p.updatePagination(p.pageIndex-1,p.pageSize,p.pageTotal),!1});this.$.on("click",'[aria-label="next"]',function(){return f.test(this.className)||p.updatePagination(p.pageIndex+1,p.pageSize,p.pageTotal),!1});this.$.on("click",'[data-role="pagination"]',function(){return u.test(this.className)||p.updatePagination(+n(this).text()),!1});n(document).on("click",function(n){!p.paginationDropdown||n.target&&t.contains(p.$.get(0),n.target)||p.paginationDropdown.parent().removeClass("open")});this.$.on("click",'[data-toggle="dropdown"]',function(){n(this).parent().toggleClass("open")});this.$.on("click",'[role="menuitem"]',function(){if(!u.test(this.className)){var t=n(this),i=+t.children().text();t.parent().parent().removeClass("open");t.addClass("active").siblings().removeClass("active");p.updatePagination(1,i)}return!1})}}}var h=/^(top|bottom|both)/,r=/^(left|right|center|justify)$/i,u=/(^|\s+)active(\s+|$)/i,f=/(^|\s+)disabled(\s+|$)/i,c="<col/>",l=['<div class="table-horizontal">','\t<div class="table-vertical">','\t\t<div class="table-core">','\t\t\t<table class="table"><colgroup><\/colgroup><thead><\/thead><tbody><\/tbody><\/table>',"\t\t<\/div>",'       <div class="table-screen"><\/div>',"\t<\/div>","<\/div>"],a=['<div class="table-fixed-head">','   <div class="table-fixed-group">','       <div class="table-cell">','\t        <table class="table{if(border) " table-bordered"^}{if(hover) " table-hover"^}"><\/table>',"       <\/div>","   <\/div>","<\/div>"],v=['<div class="table-fixed-column">','\t<table class="table{if(border) " table-bordered"^}{if(hover) " table-hover"^}"><thead><\/thead><tbody><\/tbody><\/table>',"<\/div>"],y=['<div class="table-fixed table-fixed-head table-fixed-column">','\t<table class="table{if(border) " table-bordered"^}{if(hover) " table-hover"^}"><thead><\/thead><\/table>',"<\/div>"],s=['<div class="table-pagination">','\t<div class="pull-{return paginationHAlign == "left" ? "right" : "left"^} pagination-detail hidden-xs hidden-sm">','\t\t<span class="pagination-info">显示第<var>{return pageSize * (pageIndex - 1) + 1^}<\/var>到第<var>{return Math.min(pageSize * pageIndex, pageTotal)^}<\/var>条记录，总共<strong><var>{pageTotal}<\/var><\/strong>条记录<\/span>','\t\t<div class="pagination-list">',"\t\t\t每页显示",'\t\t\t<div class="btn-group">','\t\t\t\t<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">','\t\t\t\t\t<span class="page-size">{pageSize}<\/span> <span class="caret"><\/span>',"\t\t\t\t<\/button>",'\t\t\t\t<ul class="dropdown-menu" role="menu"><\/ul>',"\t\t\t<\/div> 条记录","\t\t<\/div>","\t<\/div>",'\t<div class="pull-{return paginationHAlign == "left" ? "left" : "right"^}" aria-label="page navigation">','\t\t<ul class="pagination">','\t\t\t<li aria-label="previous">','\t\t\t\t<a href="javascript:void(0)">','\t\t\t\t\t<span aria-hidden="true">&laquo;<\/span>',"\t\t\t\t<\/a>","\t\t\t<\/li>",'\t\t\t<li aria-label="next">','\t\t\t\t<a href="javascript:void(0)">','\t\t\t\t\t<span aria-hidden="true">&raquo;<\/span>',"\t\t\t\t<\/a>","\t\t\t<\/li>","\t\t<\/ul>","\t<\/div>",'\t<div class="clearfix"><\/div>',"<\/div>"];t.register("table",p)})(jQuery,v2Kit);