(function(n,t){function i(i){return{ctor:function(){this.key="";this.value="";this.data=[];this.style="default"},init:function(){this.base.init();this.$=n(this.element);this.$.append(t.format('<button class="btn btn-{0} dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"><span data-domain="true"><\/span>&ensp;<span class="caret"><\/span><\/button><ul class="dropdown-menu"><\/ul><\/div>',this.style||"default"));this.$dropdown=this.$.find(".dropdown-menu");this.$domain=this.$.find('[data-domain="true"]')},render:function(n){this.base.render();this.addClass(n.dropup?"dropup":"dropdown")},wait:function(n){this.__wait_==null&&(this.__wait_=this.constructor("wait",{sm:!0,fade:!0,context:this.element}));this.__wait_.toggle(n)},val:function(n){if(n==null)return this.key||"";this.$dropdown.find(t.format('[data-key="{0}"]',n)).click()},ajax:function(){var r={url:null,type:"GET",params:{}};this.invoke("ajax-ready",r)!==!1&&(this.wait(!0),n.ajax(r.url,{type:r.type,dataType:"json",data:r.params,success:function(n){i.invoke("ajax-success",n)!==!1&&(n.status?(i.invoke("ajax-load",n),i.sleep(!1)&&i.load()):t.validate("<strong>错误&ensp;:<\/strong>&ensp;&ensp;"+n.message+"","danger"));i.wait(!1)},error:function(n){i.invoke("ajax-error",n.status,n);i.wait(!1)}}))},ajaxLoad:function(n){this.data=n.data},load:function(){this.resolve()},resolve:function(){this.$dropdown.empty().append(t.expression('{for(var item in data){ if(item.divider || item === "divider") { "<li role="separator" class="divider"><\/li>" } else { "<li data-key="{item.id}"><a href="#">{item.name}<\/a><\/li>" } }^}',this.data))},commit:function(){n(document).on("click",function(n){n.target&&t.contains(i.$.get(0),n.target)||i.$.removeClass("open")});this.$.find('[data-toggle="dropdown"]').click(function(){i.$.toggleClass("open")});this.$dropdown.on("click","[data-key]",function(){var t=n(this);i.$.removeClass("open");i.key=t.attr("data-key");i.$domain.text(i.value=t.text());t.addClass("active").siblings().removeClass("active")})}}}t.register("select",i)})(jQuery,v2Kit);